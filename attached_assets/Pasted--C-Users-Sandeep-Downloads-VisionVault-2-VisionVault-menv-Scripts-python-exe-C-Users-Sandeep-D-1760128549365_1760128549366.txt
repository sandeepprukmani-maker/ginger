"C:\Users\Sandeep\Downloads\VisionVault (2)\VisionVault\menv\Scripts\python.exe" "C:\Users\Sandeep\Downloads\VisionVault (2)\VisionVault\local_agent (4).py" 
Attempting polling connection to https://33bdae2f-af16-4e08-8b6b-4c45248985ea-00-3q37a1ba86qdg.kirk.replit.dev/socket.io/?transport=polling&EIO=4
Starting Browser Automation Agent
Agent ID: d501033b-5d74-4ca8-9dc4-4a809f1fe7c7
Server URL: https://33bdae2f-af16-4e08-8b6b-4c45248985ea-00-3q37a1ba86qdg.kirk.replit.dev/

Press Ctrl+C to stop the agent

Connecting to server...
Polling connection accepted with {'sid': 'Ps-l8MaGeyQkZjzgAAAQ', 'upgrades': ['websocket'], 'pingTimeout': 20000, 'pingInterval': 25000, 'maxPayload': 1000000}
Engine.IO connection established
Sending packet MESSAGE data 0{}
Attempting WebSocket upgrade to wss://33bdae2f-af16-4e08-8b6b-4c45248985ea-00-3q37a1ba86qdg.kirk.replit.dev/socket.io/?transport=websocket&EIO=4
WebSocket upgrade was successful
Received packet NOOP data 
Received packet MESSAGE data 2["connected",{"sid":"u_APDs8ialGAvA8mAAAR"}]
Received event "connected" [/]
Received packet MESSAGE data 0{"sid":"u_APDs8ialGAvA8mAAAR"}
Namespace / is connected
Emitting event "agent_register" [/]
Sending packet MESSAGE data 2["agent_register",{"agent_id":"d501033b-5d74-4ca8-9dc4-4a809f1fe7c7","browsers":["chromium"]}]
C:\Users\Sandeep\Downloads\VisionVault (2)\VisionVault\local_agent (4).py:207: DeprecationWarning: There is no current event loop
  loop = asyncio.get_event_loop()
Connected to server: https://33bdae2f-af16-4e08-8b6b-4c45248985ea-00-3q37a1ba86qdg.kirk.replit.dev/
Detected browsers: ['chromium']
Connection established! Waiting for tasks...

Received packet MESSAGE data 2["agent_registered",{"status":"success"}]
Received event "agent_registered" [/]
Received packet MESSAGE data 2["agents_update",{"agents":[{"agent_id":"d501033b-5d74-4ca8-9dc4-4a809f1fe7c7","browsers":["chromium"],"connected_at":"2025-10-10T20:34:38.005089"}]}]
Received event "agents_update" [/]
Agent registered successfully: {'status': 'success'}
Received packet PING data 
Sending packet PONG data 
Received packet MESSAGE data 2["execution_status",{"test_id":17,"status":"running","message":"Executing on agent with healing in headful mode..."}]
Received event "execution_status" [/]
Received packet MESSAGE data 2["execute_healing_attempt",{"test_id":17,"code":"\nasync def run_test(browser_name='chromium', headless=True):\n    from playwright.async_api import async_playwright\n    logs = []\n    screenshot = None\n    browser = None\n    page = None\n    try:\n        async with async_playwright() as p:\n            browser = await getattr(p, browser_name).launch(headless=headless)\n            page = await browser.new_page()\n            await page.goto(\"https://practicetestautomation.com/practice-test-login/\")\n            logs.append(\"Navigated to the login page\")\n\n            await page.fill(\"input[name='username']\", \"student\")\n            logs.append(\"Filled username\")\n\n            await page.fill(\"input[name='password']\", \"Password123\")\n            logs.append(\"Filled password\")\n\n            await page.click(\"button[type='submit']\")\n            logs.append(\"Clicked submit button\")\n\n            # CRITICAL: Screenshot BEFORE closing\n            screenshot = await page.screenshot()\n            await browser.close()\n            return {'success': True, 'logs': logs, 'screenshot': screenshot}\n    except Exception as e:\n        logs.append(f\"Error: {str(e)}\")\n        # Try to get screenshot even on error, BEFORE cleanup\n        if page:\n            try:\n                screenshot = await page.screenshot()\n            except:\n                pass\n        if browser:\n            try:\n                await browser.close()\n            except:\n                pass\n        return {'success': False, 'logs': logs, 'screenshot': screenshot}\n","browser":"chromium","mode":"headful","attempt":1}]
Received event "execute_healing_attempt" [/]
Exception in thread Thread-8 (_handle_eio_message):
Traceback (most recent call last):
  File "C:\Python313\Lib\threading.py", line 1043, in _bootstrap_inner
    self.run()
    ~~~~~~~~^^
  File "C:\Python313\Lib\threading.py", line 994, in run
    self._target(*self._args, **self._kwargs)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Sandeep\Downloads\VisionVault (2)\VisionVault\menv\Lib\site-packages\socketio\client.py", line 486, in _handle_eio_message
    self._handle_event(pkt.namespace, pkt.id, pkt.data)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Sandeep\Downloads\VisionVault (2)\VisionVault\menv\Lib\site-packages\socketio\client.py", line 361, in _handle_event
    r = self._trigger_event(data[0], namespace, *data[1:])
  File "C:\Users\Sandeep\Downloads\VisionVault (2)\VisionVault\menv\Lib\site-packages\socketio\client.py", line 409, in _trigger_event
    return handler(*args)
  File "C:\Users\Sandeep\Downloads\VisionVault (2)\VisionVault\local_agent (4).py", line 89, in handle_healing_attempt
    asyncio.get_event_loop().create_task(
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Python313\Lib\asyncio\events.py", line 716, in get_event_loop
    raise RuntimeError('There is no current event loop in thread %r.'
                       % threading.current_thread().name)
RuntimeError: There is no current event loop in thread 'Thread-8 (_handle_eio_message)'.
Received packet PING data 
Sending packet PONG data 
